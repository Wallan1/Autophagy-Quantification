---
title: "30-Statistical-Analysis"
output: html_notebook
---
ANOVA of object counts
*multiple replicates*
```{r}
temp$Rep<-as.factor(temp$Rep)

anovaLC3Counts<-aov(temp$LC3PunctaCount~temp$Type*temp$BvsS+temp$Rep+temp$Rep:temp$Type)
summary(anovaLC3Counts)
TukeyHSD(anovaLC3Counts)

anovaLC3CountsMM<-aov(temp$LC3CountMinMax~temp$Type*temp$BvsS+temp$Rep+temp$Rep:temp$Type)
summary(anovaLC3CountsMM)
TukeyHSD(anovaLC3CountsMM)

```

ANOVA of object counts; separate Basal vs Starved analysis
*multiple replicates*
```{r}
#to test segmentation of dataset
#subsetB<-temp[temp$BvsS == "Basal",]

#Basal
anovaLC3CountsBasal<-aov(LC3PunctaCount~Type+Rep, temp[temp$BvsS == "Basal",])

summary(anovaLC3CountsBasal)
TukeyHSD(anovaLC3CountsBasal)

anovaLC3CountsMMbasal<-aov(LC3CountMinMax~Type, temp[temp$BvsS == "Basal",])

summary(anovaLC3CountsMMbasal)
TukeyHSD(anovaLC3CountsMMbasal)

#Starved
anovaLC3CountsStarved<-aov(LC3PunctaCount~Type+Rep, temp[temp$BvsS == "Starved",])

summary(anovaLC3CountsStarved)
TukeyHSD(anovaLC3CountsStarved)

anovaLC3CountsMMstarved<-aov(LC3CountMinMax~Type+Rep, temp[temp$BvsS == "Starved",])

summary(anovaLC3CountsMMstarved)
TukeyHSD(anovaLC3CountsMMstarved)

```

ANOVA of object counts
*1 replicate*
```{r}
anovaLC3Counts<-aov(temp$LC3PunctaCount~temp$Type*temp$BvsS)
summary(anovaLC3Counts)
TukeyHSD(anovaLC3Counts)
```

T-Test of object counts, individual replicates
```{r}
x<-"LC3PunctaCount"
for (t in c("WT", "Control", "tepsin", "AP4E1")) {
  
  s<-temp[[x]][which(temp$BvsS=="Starved" & temp$Type==t)]
  b<-temp[[x]][which(temp$BvsS=="Basal" & temp$Type==t)]
  
  nam<-paste("t",x,t,sep="")
  assign(nam,t.test(s,b))
  }


```

ANOVA of all object metrics
*multiple replicates*
```{r}
temp$Rep<-as.factor(temp$Rep)

anovaLC3Vol<-aov(temp$AveLC3VolPerCell~temp$Type*temp$BvsS+temp$Rep+temp$Rep:temp$Type)
summary(anovaLC3Vol)
TukeyHSD(anovaLC3Vol)

#anovaMeanLC3PuncInt<-aov(temp$AveLC3IntPerCell~temp$Type*temp$BvsS+temp$Rep+temp$Rep:temp$Type)
#summary(anovaMeanLC3PuncInt)
#TukeyHSD(anovaMeanLC3PuncInt)

anovaSumLC3PuncInt<-aov(temp$AveLC3SumIntPerCell~temp$Type*temp$BvsS+temp$Rep+temp$Rep:temp$Type)
summary(anovaSumLC3PuncInt)
TukeyHSD(anovaSumLC3PuncInt)

anovaTotLC3Int<-aov(temp$TotLC3IntPerCell~temp$Type*temp$BvsS+temp$Rep+temp$Rep:temp$Type)
summary(anovaTotLC3Int)
TukeyHSD(anovaTotLC3Int)

anovaLAMPVol<-aov(temp$AveLAMPVolPerCell~temp$Type*temp$BvsS+temp$Rep+temp$Rep:temp$Type)
summary(anovaLAMPVol)
TukeyHSD(anovaLAMPVol)

#anovaMeanLAMPPuncInt<-aov(temp$AveLAMPIntPerCell~temp$Type*temp$BvsS+temp$Rep+temp$Rep:temp$Type)
#summary(anovaMeanLAMPPuncInt)
#TukeyHSD(anovaMeanLAMPPuncInt)

anovaSumLAMPPuncInt<-aov(temp$AveLAMPSumIntPerCell~temp$Type*temp$BvsS+temp$Rep+temp$Rep:temp$Type)
summary(anovaSumLAMPPuncInt)
TukeyHSD(anovaSumLAMPPuncInt)

anovaTotLAMPInt<-aov(temp$TotLAMPIntPerCell~temp$Type*temp$BvsS+temp$Rep+temp$Rep:temp$Type)
summary(anovaTotLAMPInt)
TukeyHSD(anovaTotLAMPInt)
```

single replicate ANOVA of Individual Puncta metrics
*for stats of single replicates*
```{r}
#anovaLC3Vol<-aov(temp$AveLC3VolPerCell~temp$Type*temp$BvsS)
#summary(anovaLC3Vol)
#TukeyHSD(anovaLC3Vol)

#anovaMeanLC3PuncInt<-aov(temp$AveLC3IntPerCell~temp$Type*temp$BvsS)
#summary(anovaMeanLC3PuncInt)
#TukeyHSD(anovaMeanLC3PuncInt)

#anovaSumLC3PuncInt<-aov(temp$AveLC3SumIntPerCell~temp$Type*temp$BvsS)
#summary(anovaSumLC3PuncInt)
#TukeyHSD(anovaSumLC3PuncInt)

#anovaTotLC3Int<-aov(temp$TotLC3IntPerCell~temp$Type*temp$BvsS)
#summary(anovaTotLC3Int)
#TukeyHSD(anovaTotLC3Int)

#anovaLAMPVol<-aov(temp$AveLAMPVolPerCell~temp$Type*temp$BvsS)
#summary(anovaLAMPVol)
#TukeyHSD(anovaLAMPVol)

#anovaMeanLAMPPuncInt<-aov(temp$AveLAMPIntPerCell~temp$Type*temp$BvsS)
#summary(anovaMeanLAMPPuncInt)
#TukeyHSD(anovaMeanLAMPPuncInt)

#anovaSumLAMPPuncInt<-aov(temp$AveLAMPSumIntPerCell~temp$Type*temp$BvsS)
#summary(anovaSumLAMPPuncInt)
#TukeyHSD(anovaSumLAMPPuncInt)

#anovaTotLAMPInt<-aov(temp$TotLAMPIntPerCell~temp$Type*temp$BvsS)
#summary(anovaTotLAMPInt)
#TukeyHSD(anovaTotLAMPInt)
```

Use for ANOVA run to cycle through basal and starved separately on single replicates
*need to manually run summary and TukeyHSD*

```{r}
for (b in c("Basal","Starved")) {
    for (x in c("AveLC3VolPerCell","AveLC3IntPerCell","AveLC3SumIntPerCell","TotLC3IntPerCell","AveLAMPVolPerCell","AveLAMPIntPerCell","AveLAMPSumIntPerCell","TotLAMPIntPerCell")){
      for (r in c("1","2","3")) {
  nam<-paste("a",r,b,x,sep="")
  assign(nam,aov(temp[[x]][which(temp$BvsS==b & temp$Rep==r)] ~ temp$Type[which(temp$BvsS==b & temp$Rep==r)]))
  
    }
}
  }
```

Single replicate T-test for analysis of basal versus starved
*visualize in environment tab*
```{r}
for (t in c("WT", "Control", "tepsin", "AP4E1")) {
  for (x in c("AveLC3VolPerCell","AveLC3IntPerCell","AveLC3SumIntPerCell","TotLC3IntPerCell","AveLAMPVolPerCell","AveLAMPIntPerCell","AveLAMPSumIntPerCell","TotLAMPIntPerCell")){
  s<-temp[[x]][which(temp$BvsS=="Starved" & temp$Type==t)]
  b<-temp[[x]][which(temp$BvsS=="Basal" & temp$Type==t)]
  
  nam<-paste("t",x,t,sep="")
  assign(nam,t.test(s,b))
  }
}

```